package me.lefted.solution;

import java.util.Arrays;
import java.util.List;
import java.util.function.Supplier;
import java.util.stream.Collector;
import java.util.stream.Collectors;
import java.util.stream.LongStream;
import java.util.stream.Stream;

public class SolutionPart2 {

    public static void main(String[] args) {
	String input = "18\r\n" + "19\r\n" + "46\r\n" + "14\r\n" + "29\r\n" + "45\r\n" + "40\r\n" + "47\r\n" + "25\r\n" + "43\r\n" + "36\r\n" + "22\r\n"
	    + "21\r\n" + "4\r\n" + "32\r\n" + "33\r\n" + "37\r\n" + "38\r\n" + "26\r\n" + "2\r\n" + "42\r\n" + "15\r\n" + "5\r\n" + "13\r\n" + "31\r\n"
	    + "9\r\n" + "6\r\n" + "30\r\n" + "7\r\n" + "14\r\n" + "10\r\n" + "8\r\n" + "69\r\n" + "11\r\n" + "12\r\n" + "25\r\n" + "16\r\n" + "17\r\n"
	    + "22\r\n" + "19\r\n" + "18\r\n" + "20\r\n" + "51\r\n" + "21\r\n" + "24\r\n" + "23\r\n" + "26\r\n" + "15\r\n" + "60\r\n" + "13\r\n" + "29\r\n"
	    + "27\r\n" + "44\r\n" + "42\r\n" + "28\r\n" + "38\r\n" + "30\r\n" + "36\r\n" + "31\r\n" + "32\r\n" + "33\r\n" + "34\r\n" + "35\r\n" + "37\r\n"
	    + "55\r\n" + "39\r\n" + "40\r\n" + "70\r\n" + "41\r\n" + "43\r\n" + "78\r\n" + "58\r\n" + "73\r\n" + "101\r\n" + "60\r\n" + "56\r\n" + "57\r\n"
	    + "75\r\n" + "59\r\n" + "67\r\n" + "71\r\n" + "61\r\n" + "68\r\n" + "110\r\n" + "69\r\n" + "80\r\n" + "72\r\n" + "112\r\n" + "76\r\n" + "79\r\n"
	    + "144\r\n" + "129\r\n" + "114\r\n" + "84\r\n" + "99\r\n" + "113\r\n" + "132\r\n" + "115\r\n" + "148\r\n" + "116\r\n" + "118\r\n" + "120\r\n"
	    + "128\r\n" + "126\r\n" + "187\r\n" + "130\r\n" + "190\r\n" + "152\r\n" + "229\r\n" + "141\r\n" + "151\r\n" + "155\r\n" + "299\r\n" + "209\r\n"
	    + "163\r\n" + "239\r\n" + "183\r\n" + "197\r\n" + "331\r\n" + "212\r\n" + "228\r\n" + "270\r\n" + "231\r\n" + "234\r\n" + "236\r\n" + "244\r\n"
	    + "246\r\n" + "355\r\n" + "256\r\n" + "392\r\n" + "271\r\n" + "342\r\n" + "292\r\n" + "360\r\n" + "296\r\n" + "306\r\n" + "318\r\n" + "346\r\n"
	    + "602\r\n" + "375\r\n" + "380\r\n" + "395\r\n" + "534\r\n" + "456\r\n" + "440\r\n" + "459\r\n" + "470\r\n" + "502\r\n" + "478\r\n" + "480\r\n"
	    + "490\r\n" + "517\r\n" + "527\r\n" + "548\r\n" + "563\r\n" + "1082\r\n" + "1136\r\n" + "896\r\n" + "1044\r\n" + "614\r\n" + "693\r\n" + "698\r\n"
	    + "988\r\n" + "755\r\n" + "1065\r\n" + "1352\r\n" + "835\r\n" + "899\r\n" + "915\r\n" + "942\r\n" + "929\r\n" + "1173\r\n" + "958\r\n" + "1043\r\n"
	    + "970\r\n" + "1007\r\n" + "1075\r\n" + "1090\r\n" + "1529\r\n" + "1750\r\n" + "1663\r\n" + "1307\r\n" + "1312\r\n" + "1533\r\n" + "1369\r\n"
	    + "1391\r\n" + "1705\r\n" + "1590\r\n" + "1654\r\n" + "1734\r\n" + "1764\r\n" + "1805\r\n" + "2923\r\n" + "2649\r\n" + "1936\r\n" + "1899\r\n"
	    + "2633\r\n" + "1928\r\n" + "2681\r\n" + "1977\r\n" + "3956\r\n" + "2165\r\n" + "2981\r\n" + "2619\r\n" + "3926\r\n" + "2676\r\n" + "2840\r\n"
	    + "2703\r\n" + "4292\r\n" + "4547\r\n" + "4383\r\n" + "4628\r\n" + "3244\r\n" + "3388\r\n" + "3539\r\n" + "6659\r\n" + "6602\r\n" + "5143\r\n"
	    + "3827\r\n" + "5316\r\n" + "8558\r\n" + "3905\r\n" + "5322\r\n" + "4142\r\n" + "4817\r\n" + "4784\r\n" + "9069\r\n" + "5379\r\n" + "11206\r\n"
	    + "5516\r\n" + "7536\r\n" + "10701\r\n" + "6242\r\n" + "7293\r\n" + "6632\r\n" + "15190\r\n" + "11260\r\n" + "7366\r\n" + "7732\r\n" + "7681\r\n"
	    + "7969\r\n" + "8959\r\n" + "9521\r\n" + "8611\r\n" + "8047\r\n" + "10139\r\n" + "8689\r\n" + "16605\r\n" + "8926\r\n" + "10300\r\n" + "10163\r\n"
	    + "10895\r\n" + "15262\r\n" + "12148\r\n" + "13925\r\n" + "12874\r\n" + "15025\r\n" + "13974\r\n" + "19229\r\n" + "14313\r\n" + "15047\r\n"
	    + "15098\r\n" + "15335\r\n" + "15413\r\n" + "16370\r\n" + "16016\r\n" + "16658\r\n" + "27899\r\n" + "16736\r\n" + "18852\r\n" + "35245\r\n"
	    + "17615\r\n" + "19089\r\n" + "19821\r\n" + "29984\r\n" + "23769\r\n" + "23043\r\n" + "30309\r\n" + "31705\r\n" + "26799\r\n" + "26848\r\n"
	    + "35105\r\n" + "28287\r\n" + "30382\r\n" + "42183\r\n" + "30748\r\n" + "30433\r\n" + "31351\r\n" + "31429\r\n" + "32386\r\n" + "32674\r\n"
	    + "33394\r\n" + "44635\r\n" + "34351\r\n" + "50281\r\n" + "36704\r\n" + "60293\r\n" + "69456\r\n" + "42864\r\n" + "49891\r\n" + "46812\r\n"
	    + "49842\r\n" + "53647\r\n" + "55086\r\n" + "85047\r\n" + "119298\r\n" + "60961\r\n" + "75099\r\n" + "62099\r\n" + "73297\r\n" + "94916\r\n"
	    + "61784\r\n" + "62780\r\n" + "63815\r\n" + "75250\r\n" + "96654\r\n" + "67745\r\n" + "104928\r\n" + "71055\r\n" + "111242\r\n" + "133358\r\n"
	    + "89676\r\n" + "92706\r\n" + "151460\r\n" + "134938\r\n" + "101898\r\n" + "158753\r\n" + "108733\r\n" + "122831\r\n" + "122745\r\n" + "123060\r\n"
	    + "293691\r\n" + "126595\r\n" + "165971\r\n" + "142995\r\n" + "125599\r\n" + "130525\r\n" + "146305\r\n" + "194115\r\n" + "402424\r\n"
	    + "179788\r\n" + "138800\r\n" + "226064\r\n" + "160731\r\n" + "182382\r\n" + "235256\r\n" + "191574\r\n" + "194604\r\n" + "210631\r\n"
	    + "224643\r\n" + "269464\r\n" + "231478\r\n" + "231564\r\n" + "245576\r\n" + "253585\r\n" + "248659\r\n" + "252194\r\n" + "276830\r\n"
	    + "256124\r\n" + "411266\r\n" + "371362\r\n" + "299531\r\n" + "354846\r\n" + "654618\r\n" + "340519\r\n" + "330374\r\n" + "459212\r\n"
	    + "343113\r\n" + "695365\r\n" + "431041\r\n" + "386178\r\n" + "402205\r\n" + "405235\r\n" + "435274\r\n" + "456121\r\n" + "633683\r\n"
	    + "504783\r\n" + "477140\r\n" + "586095\r\n" + "701736\r\n" + "500853\r\n" + "508318\r\n" + "654377\r\n" + "555655\r\n" + "640050\r\n"
	    + "741024\r\n" + "642644\r\n" + "673487\r\n" + "1288060\r\n" + "802325\r\n" + "716552\r\n" + "729291\r\n" + "1497690\r\n" + "1073685\r\n"
	    + "1273733\r\n" + "821452\r\n" + "807440\r\n" + "891395\r\n" + "912414\r\n" + "933261\r\n" + "977993\r\n" + "1117190\r\n" + "1140903\r\n"
	    + "1210054\r\n" + "1009171\r\n" + "1143497\r\n" + "1063973\r\n" + "1445843\r\n" + "1195705\r\n" + "1282694\r\n" + "2428963\r\n" + "1316131\r\n"
	    + "1390039\r\n" + "1518877\r\n" + "2095183\r\n" + "2337706\r\n" + "1536731\r\n" + "1628892\r\n" + "1698835\r\n" + "2076758\r\n" + "1712847\r\n"
	    + "1803809\r\n" + "1824656\r\n" + "1845675\r\n" + "2962865\r\n" + "1987164\r\n" + "2073144\r\n" + "2150074\r\n" + "2152668\r\n" + "2204876\r\n"
	    + "2207470\r\n" + "2981529\r\n" + "2478399\r\n" + "3128369\r\n" + "2908916\r\n" + "4192040\r\n" + "2706170\r\n" + "2926770\r\n" + "3055608\r\n"
	    + "3790973\r\n" + "3165623\r\n" + "3235566\r\n" + "3327727\r\n" + "3502644\r\n" + "5835686\r\n" + "3516656\r\n" + "3628465\r\n" + "3670331\r\n"
	    + "7131109\r\n" + "5941736\r\n" + "5116386\r\n" + "4278020\r\n" + "4913640\r\n" + "4412346\r\n" + "5186405\r\n" + "4685869\r\n" + "7293617\r\n"
	    + "5834539\r\n" + "5615086\r\n" + "6383335\r\n" + "5632940\r\n" + "9001309\r\n" + "5982378\r\n" + "6221231\r\n" + "6401189\r\n" + "6493350\r\n"
	    + "6563293\r\n" + "6830371\r\n" + "8188513\r\n" + "7145121\r\n" + "10907100\r\n" + "10354082\r\n" + "7948351\r\n" + "11998421\r\n" + "8690366\r\n"
	    + "9528732\r\n" + "8963889\r\n" + "15987022\r\n" + "10318809\r\n" + "9872274\r\n" + "13376235\r\n" + "16136864\r\n" + "11248026\r\n"
	    + "12016275\r\n" + "14983687\r\n" + "17469257\r\n" + "12203609\r\n" + "12383567\r\n" + "26433146\r\n" + "12894539\r\n" + "13056643\r\n"
	    + "13393664\r\n" + "13975492\r\n" + "15093472\r\n" + "26270774\r\n" + "16638717\r\n" + "16912240\r\n" + "18492621\r\n" + "17654255\r\n"
	    + "22066601\r\n" + "25440210\r\n" + "18836163\r\n" + "20191083\r\n" + "21120300\r\n" + "23264301\r\n" + "26870031\r\n" + "33085622\r\n"
	    + "23451635\r\n" + "24399842\r\n" + "24587176\r\n" + "25098148\r\n" + "51578243\r\n" + "35095792\r\n" + "34176943\r\n" + "37980840\r\n"
	    + "35460265\r\n" + "27369156\r\n" + "29068964\r\n" + "37160073\r\n" + "33550957\r\n" + "36146876\r\n" + "62568016\r\n" + "47164749\r\n"
	    + "41311383\r\n" + "44778259\r\n" + "45631293\r\n" + "39027246\r\n" + "52333265\r\n" + "55938995\r\n" + "48549783\r\n" + "50321666\r\n"
	    + "77431413\r\n" + "47851477\r\n" + "48987018\r\n" + "65898559\r\n" + "52467304\r\n" + "83311625\r\n" + "68646749\r\n" + "74487511\r\n"
	    + "69011222\r\n" + "80925135\r\n" + "76187319\r\n" + "62619921\r\n" + "115214565\r\n" + "167547830\r\n" + "136864130\r\n" + "91943008\r\n"
	    + "131266670\r\n" + "80338629\r\n" + "83805505\r\n" + "86878723\r\n" + "87577029\r\n" + "100184742\r\n" + "117561005\r\n" + "139346027\r\n"
	    + "116498226\r\n" + "96838495\r\n" + "129912153\r\n" + "101454322\r\n" + "115087225\r\n" + "213051449\r\n" + "150674830\r\n" + "246410379\r\n"
	    + "154562929\r\n" + "216668887\r\n" + "138807240\r\n" + "195425854\r\n" + "142958550\r\n" + "164144134\r\n" + "267732572\r\n" + "167217352\r\n"
	    + "167915658\r\n" + "170684228\r\n" + "185259827\r\n" + "171382534\r\n" + "244412872\r\n" + "184415524\r\n" + "265598456\r\n" + "198292817\r\n"
	    + "211925720\r\n" + "213336721\r\n" + "334233094\r\n" + "216541547\r\n" + "240261562\r\n" + "253894465\r\n" + "369675351\r\n" + "281765790\r\n"
	    + "335133010\r\n" + "323222764\r\n" + "505860018\r\n" + "328218377\r\n" + "354884270\r\n" + "307102684\r\n" + "331361486\r\n" + "337901580\r\n"
	    + "379143072\r\n" + "338599886\r\n" + "342066762\r\n" + "456803109\r\n" + "355798058\r\n" + "382708341\r\n" + "594634061\r\n" + "410218537\r\n"
	    + "536559485\r\n" + "425262441\r\n" + "429878268\r\n" + "547903033\r\n" + "523644231\r\n" + "535660255\r\n" + "585255951\r\n" + "753480818\r\n"
	    + "588868474\r\n" + "630325448\r\n" + "662900742\r\n" + "788164595\r\n" + "635321061\r\n" + "638464170\r\n" + "645004264\r\n" + "669263066\r\n"
	    + "734941130\r\n" + "680666648\r\n" + "694397944\r\n" + "1055587889\r\n" + "1363661010\r\n" + "738506399\r\n" + "792926878\r\n" + "945878792\r\n"
	    + "1277125049\r\n" + "1108900182\r\n" + "1357298686\r\n" + "1298221803\r\n" + "776203571\r\n" + "1275329712\r\n" + "1124528729\r\n"
	    + "1174124425\r\n" + "1343567390\r\n" + "1219193922\r\n" + "1310992096\r\n" + "1759849790\r\n" + "1527868008\r\n" + "1428247939\r\n"
	    + "1283468434\r\n" + "1314267330\r\n" + "1349929714\r\n" + "1375064592\r\n" + "1917455607\r\n" + "2517415725\r\n" + "1531433277\r\n"
	    + "1514709970\r\n" + "2328094104\r\n" + "2959681216\r\n" + "1722082363\r\n" + "2811336442\r\n" + "1885103753\r\n" + "1900732300\r\n"
	    + "2126133285\r\n" + "1950327996\r\n" + "2884378519\r\n" + "2552776668\r\n" + "2549189017\r\n" + "2502662356\r\n" + "2530186018\r\n"
	    + "2594460530\r\n" + "2633398148\r\n" + "2597735764\r\n" + "2658533026\r\n" + "5542911545\r\n" + "2664197044\r\n" + "2724994306\r\n"
	    + "4032125695\r\n" + "3046143247\r\n" + "4048849002\r\n" + "3236792333\r\n" + "3399813723\r\n" + "3607186116\r\n" + "6636606056\r\n"
	    + "3622814663\r\n" + "6048128775\r\n" + "6109848472\r\n" + "3851060296\r\n" + "4076461281\r\n" + "7094992249\r\n" + "5032848374\r\n"
	    + "5051851373\r\n" + "5079375035\r\n" + "5097122886\r\n" + "5124646548\r\n" + "5192196294\r\n" + "5231133912\r\n" + "6843978449\r\n"
	    + "5322730070\r\n" + "5771137553\r\n" + "7268918028\r\n" + "7448662725\r\n" + "6445956970\r\n" + "7122604528\r\n" + "6859606996\r\n"
	    + "7006999839\r\n" + "7022628386\r\n" + "10068771633\r\n" + "14029628225\r\n" + "7473874959\r\n" + "10514926364\r\n" + "13866606835\r\n"
	    + "7927521577\r\n" + "9109309655\r\n" + "10084699747\r\n" + "12705008871\r\n" + "12219727414\r\n" + "10176497921\r\n" + "10316842842\r\n"
	    + "10355780460\r\n" + "12253762298\r\n" + "10553863982\r\n" + "19522680326\r\n" + "21340481794\r\n" + "12630744549\r\n" + "13305563966\r\n"
	    + "13452956809\r\n" + "13468585356\r\n" + "13882235382\r\n" + "14480874798\r\n" + "14934521416\r\n" + "17199126307\r\n" + "19663173637\r\n"
	    + "15401396536\r\n" + "16583184614\r\n" + "17036831232\r\n" + "23021851713\r\n" + "18104019498\r\n" + "32584894296\r\n" + "24022449338\r\n"
	    + "37475406147\r\n" + "30076544308\r\n" + "20672623302\r\n" + "37709454534\r\n" + "20909644442\r\n" + "22807626280\r\n" + "23184608531\r\n"
	    + "25936308515\r\n" + "26083701358\r\n" + "27187799348\r\n" + "28240085382\r\n" + "26921542165\r\n" + "28403106772\r\n" + "28363110180\r\n"
	    + "29415396214\r\n" + "46507126270\r\n" + "48026283817\r\n" + "35140850730\r\n" + "40058682945\r\n" + "41059280570\r\n" + "43480249582\r\n"
	    + "43694475015\r\n" + "38776642800\r\n" + "49268309889\r\n" + "46993345800\r\n" + "41582267744\r\n" + "43717270722\r\n" + "55590906120\r\n"
	    + "49272754622\r\n" + "44094252973\r\n" + "71720334964\r\n" + "49120917046\r\n" + "92815392061\r\n" + "53005243523\r\n" + "54109341513\r\n"
	    + "91506533399\r\n" + "55284652345\r\n" + "79835923370\r\n" + "104405569391\r\n" + "76408742014\r\n" + "91720758832\r\n" + "73917493530\r\n"
	    + "78835325745\r\n" + "85769988600\r\n" + "80358910544\r\n" + "140841675878\r\n" + "124053385559\r\n" + "113302602708\r\n" + "120126012736\r\n"
	    + "85299538466\r\n" + "123190248152\r\n" + "142088146683\r\n" + "125529659060\r\n" + "93367007595\r\n" + "236492850860\r\n" + "107114585036\r\n"
	    + "102126160569\r\n" + "108289895868\r\n" + "130518083527\r\n" + "174235354249\r\n" + "165424026929\r\n" + "140584190811\r\n" + "170556084577\r\n"
	    + "150326235544\r\n" + "161708280480\r\n" + "192137928453\r\n" + "180961486314\r\n" + "205425551202\r\n" + "166128899144\r\n" + "165658449010\r\n"
	    + "178666546061\r\n" + "200481592631\r\n" + "233951198406\r\n" + "307551711771\r\n" + "187425699035\r\n" + "306713089955\r\n" + "201656903463\r\n"
	    + "195493168164\r\n" + "209240745605\r\n" + "366092245096\r\n" + "238807979395\r\n" + "210416056437\r\n" + "366610491775\r\n" + "302292471291\r\n"
	    + "290910426355\r\n" + "374535389217\r\n" + "311140275388\r\n" + "312034516024\r\n" + "331787348154\r\n" + "327366729490\r\n" + "402138496094\r\n"
	    + "344324995071\r\n" + "344795445205\r\n" + "353084148045\r\n" + "387907291666\r\n" + "374159714225\r\n" + "491392018986\r\n" + "434301147559\r\n"
	    + "382918867199\r\n" + "389082602498\r\n" + "503949374754\r\n" + "397150071627\r\n" + "715274021156\r\n" + "419656802042\r\n" + "449224035832\r\n"
	    + "512708527728\r\n" + "612554552531\r\n" + "593202897646\r\n" + "776673885311\r\n" + "685675664605\r\n" + "623174791412\r\n" + "638507004878\r\n"
	    + "736003015244\r\n" + "659154077644\r\n" + "886868241953\r\n" + "733878047703\r\n" + "763981797113\r\n" + "1269787109152\r\n" + "750234219672\r\n"
	    + "763242316723\r\n" + "1248711542972\r\n" + "780068938826\r\n" + "1048236680142\r\n" + "1862990006798\r\n" + "1418575943704\r\n"
	    + "1620746289656\r\n" + "2003665156855\r\n" + "2198644882530\r\n" + "868880837874\r\n" + "2005790124396\r\n" + "1205757450177\r\n"
	    + "1216377689058\r\n" + "1297661082522\r\n" + "1324182669483\r\n" + "3868780131194\r\n" + "1261681796290\r\n" + "1372385052581\r\n"
	    + "1393032125347\r\n" + "1409388297316\r\n" + "1497120364426\r\n" + "1484112267375\r\n" + "1513476536395\r\n" + "1530303158498\r\n"
	    + "1543311255549\r\n" + "1632123154597\r\n" + "1648949776700\r\n" + "1828305618968\r\n" + "2532348947517\r\n" + "2241265890455\r\n"
	    + "2946610859222\r\n" + "2074638288051\r\n" + "2193063507357\r\n" + "2517830614574\r\n" + "2085258526932\r\n" + "2422135139235\r\n"
	    + "2585864465773\r\n" + "2514038771580\r\n" + "2654713921637\r\n" + "2893804950887\r\n" + "2634066848871\r\n" + "2745794063665\r\n"
	    + "2765417177928\r\n" + "4424108109385\r\n" + "2893500564691\r\n" + "2981232631801\r\n" + "7009972575158\r\n" + "3043779694893\r\n"
	    + "3073614414047\r\n" + "3175434410146\r\n" + "6249048824193\r\n" + "4606987235568\r\n" + "4250440758203\r\n" + "4827130356228\r\n"
	    + "4159896814983\r\n" + "7588219867369\r\n" + "4599297298512\r\n" + "7672911712559\r\n" + "4507393666167\r\n" + "10418705776224\r\n"
	    + "5076849060872\r\n" + "5099903237353\r\n" + "5689473181726\r\n" + "5527871799758\r\n" + "5399484026799\r\n" + "14682884287717\r\n"
	    + "5511211241593\r\n" + "5658917742619\r\n" + "7497722523432\r\n" + "5874733196492\r\n" + "6025012326694\r\n" + "6117394108940\r\n"
	    + "7425875168349\r\n" + "7233511229030\r\n" + "7335331225129\r\n" + "8410337573186\r\n" + "9327289819075\r\n" + "10127169098270\r\n"
	    + "8987027171211\r\n" + "12734815251928\r\n" + "19190277953884\r\n" + "9906877692966\r\n" + "22180606811149\r\n" + "9584242727039\r\n"
	    + "12825359195148\r\n" + "10176752298225\r\n" + "15596350874692\r\n" + "10910695268392\r\n" + "11170128984212\r\n" + "11058401769418\r\n"
	    + "11385944438085\r\n" + "11533650939111\r\n" + "11683930069313\r\n" + "14435349899880\r\n" + "13210064421621\r\n" + "28298000920089\r\n"
	    + "13350905337970\r\n" + "21660820037381\r\n" + "16560801048105\r\n" + "16919573952168\r\n" + "20713234257160\r\n" + "18314316990286\r\n"
	    + "18571269898250\r\n" + "24120759690013\r\n" + "19491120420005\r\n" + "19760995025264\r\n" + "20083629991191\r\n" + "20494937995431\r\n"
	    + "20642644496457\r\n" + "29372718759704\r\n" + "21235154067643\r\n" + "31146939463349\r\n" + "31469574429276\r\n" + "39831651859200\r\n"
	    + "31553339764849\r\n" + "23069874507398\r\n" + "26560969759591\r\n" + "45904924329156\r\n" + "50681729449604\r\n" + "32842025757975\r\n"
	    + "30270479290138\r\n" + "31665222328256\r\n" + "33480375000273\r\n" + "34875118038391\r\n" + "55785982018269\r\n" + "40255933020695\r\n"
	    + "36885586888536\r\n" + "38062390318255\r\n" + "39252115445269\r\n" + "39844625016455\r\n" + "40403639521721\r\n" + "47055907755022\r\n"
	    + "67698552251479\r\n" + "41877798564100\r\n" + "53340353797536\r\n" + "59297544385898\r\n" + "49630844266989\r\n" + "54539448936674\r\n"
	    + "62321989952667\r\n" + "54623214272247\r\n" + "83941494643558\r\n" + "72686650774430\r\n" + "63112505048113\r\n" + "113794234497717\r\n"
	    + "123786119660013\r\n" + "68355493038664\r\n" + "88215471835927\r\n" + "98549659831167\r\n" + "71760704926927\r\n";
	String test = "35\r\n" + "20\r\n" + "15\r\n" + "25\r\n" + "47\r\n" + "40\r\n" + "62\r\n" + "55\r\n" + "65\r\n" + "95\r\n" + "102\r\n" + "117\r\n"
	    + "150\r\n" + "182\r\n" + "127\r\n" + "219\r\n" + "299\r\n" + "277\r\n" + "309\r\n" + "576";

	List<Long> numberList = Arrays.asList(input.split("\r\n")).stream().map(str -> Long.parseLong(str)).collect(Collectors.toList());
	long invalidNumber = 0;
	long weaknes = 0;

	invalidNumber = findNumber(numberList, 25);
	weaknes = findWeaknes(numberList, invalidNumber);

	System.out.println(String.format("Invalid Number %s", invalidNumber));
	System.out.println(String.format("Weaknes %s", weaknes));
    }

    public static long findWeaknes(List<Long> input, long invalidNumber) {

	for (int start = 0; start < input.size() - 1; ++start) {
	    for (int end = start + 1; end < input.size(); ++end) {

		List<Long> test = input.subList(start, end + 1);
		Supplier<LongStream> streamSupplier = () -> test.stream().mapToLong(Long::longValue);
		if (streamSupplier.get().sum() == invalidNumber)
		    return streamSupplier.get().min().getAsLong() + streamSupplier.get().max().getAsLong();
	    }
	}
	return 0;
    }

    public static long findNumber(List<Long> input, int preambleSize) {

	for (int i = preambleSize; i < input.size(); ++i) {
	    List<Long> testInput = input.subList(i - preambleSize, i);
	    long numberToTest = input.get(i);
	    if (!isValid(testInput, numberToTest))
		return numberToTest;
	}
	return 0;
    }

    public static boolean isValid(List<Long> input, long numberToTest) {

	for (long i : input) {
	    for (long j : input) {

		if (i != j) {
		    if (i + j == numberToTest)
			return true;
		}
	    }
	}
	return false;
    }
}